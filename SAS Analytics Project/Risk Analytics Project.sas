


/* Customer Information Data: 200 Records */
data customer_info;
    input customer_id age income credit_score region $ employment_status $;
    datalines;
1001 25 15000 710 Gauteng Employed
1002 42 32000 640 WesternCape SelfEmployed
1003 35 18000 580 Limpopo Employed
1004 29 22000 720 Gauteng Employed
1005 55 28000 690 KwaZuluNatal Retired
1006 31 12000 560 Mpumalanga Unemployed
1007 47 40000 750 Gauteng Employed
1008 38 26000 610 EasternCape Employed
1009 45 21000 600 Limpopo Employed
1010 27 17000 655 NorthWest Employed
1011 33 19000 680 FreeState Employed
1012 52 36000 710 KwaZuluNatal SelfEmployed
1013 41 27000 640 NorthernCape Employed
1014 29 16000 590 Mpumalanga Employed
1015 23 11000 550 Gauteng Unemployed
1016 48 43000 720 WesternCape Employed
1017 36 25000 670 NorthWest Employed
1018 39 30000 700 Gauteng Employed
1019 54 31000 685 Limpopo SelfEmployed
1020 26 14000 610 EasternCape Employed
1021 28 20000 730 Gauteng Employed
1022 30 23000 645 KwaZuluNatal Employed
1023 46 37000 710 WesternCape Employed
1024 43 33000 600 Limpopo SelfEmployed
1025 37 24000 675 NorthWest Employed
1026 32 19000 580 FreeState Employed
1027 56 29000 695 Mpumalanga Retired
1028 49 42000 740 Gauteng Employed
1029 25 15000 620 EasternCape Employed
1030 40 31000 710 KwaZuluNatal SelfEmployed
1031 27 18000 650 Gauteng Employed
1032 34 21000 600 NorthWest Employed
1033 51 35000 690 FreeState Employed
1034 29 17000 570 Limpopo Employed
1035 38 28000 660 WesternCape Employed
1036 47 39000 700 Mpumalanga Employed
1037 53 34000 720 Gauteng SelfEmployed
1038 45 31000 680 KwaZuluNatal Employed
1039 24 13000 560 EasternCape Unemployed
1040 31 22000 640 Limpopo Employed
1041 33 25000 660 FreeState Employed
1042 28 16000 630 NorthWest Employed
1043 42 37000 710 WesternCape Employed
1044 55 41000 745 Gauteng Retired
1045 35 23000 700 KwaZuluNatal Employed
1046 48 39000 730 Mpumalanga Employed
1047 26 15000 580 EasternCape Employed
1048 40 26000 690 Limpopo SelfEmployed
1049 30 20000 670 NorthWest Employed
1050 39 29000 710 Gauteng Employed
1051 44 32000 690 WesternCape Employed
1052 50 37000 705 KwaZuluNatal SelfEmployed
1053 27 18000 610 FreeState Employed
1054 36 24000 680 Mpumalanga Employed
1055 29 17000 650 EasternCape Employed
1056 41 31000 700 Limpopo Employed
1057 58 42000 740 Gauteng Retired
1058 32 20000 660 KwaZuluNatal Employed
1059 37 25000 695 WesternCape Employed
1060 46 36000 710 NorthWest Employed
1061 24 12000 570 FreeState Unemployed
1062 30 19000 600 Limpopo Employed
1063 39 28000 675 Mpumalanga Employed
1064 43 32000 710 Gauteng Employed
1065 54 39000 730 KwaZuluNatal SelfEmployed
1066 26 15000 580 EasternCape Employed
1067 35 23000 670 FreeState Employed
1068 48 41000 725 WesternCape Employed
1069 31 21000 660 NorthWest Employed
1070 40 30000 705 Limpopo Employed
1071 28 18000 640 Mpumalanga Employed
1072 47 38000 720 Gauteng Employed
1073 50 36000 690 KwaZuluNatal SelfEmployed
1074 25 13000 590 EasternCape Unemployed
1075 34 22000 650 NorthWest Employed
1076 38 27000 685 WesternCape Employed
1077 42 31000 710 Limpopo Employed
1078 56 40000 740 Gauteng Retired
1079 29 19000 620 FreeState Employed
1080 45 34000 700 KwaZuluNatal Employed
1081 33 21000 660 WesternCape Employed
1082 39 26000 690 Mpumalanga Employed
1083 49 37000 720 Limpopo Employed
1084 27 17000 640 EasternCape Employed
1085 36 25000 680 NorthWest Employed
1086 41 30000 710 Gauteng Employed
1087 53 38000 735 WesternCape SelfEmployed
1088 24 14000 560 FreeState Unemployed
1089 31 20000 650 Limpopo Employed
1090 37 27000 695 KwaZuluNatal Employed
1091 46 36000 720 WesternCape Employed
1092 55 41000 740 Gauteng Retired
1093 28 18000 600 EasternCape Employed
1094 30 21000 630 Mpumalanga Employed
1095 44 33000 705 Limpopo Employed
1096 38 29000 680 NorthWest Employed
1097 50 37000 720 KwaZuluNatal SelfEmployed
1098 26 16000 610 FreeState Employed
1099 34 22000 660 Gauteng Employed
1100 40 31000 700 WesternCape Employed
1101 29 19000 665 Limpopo Employed
1102 32 21000 675 Mpumalanga Employed
1103 47 38000 720 Gauteng Employed
1104 35 24000 690 KwaZuluNatal Employed
1105 51 35000 725 WesternCape SelfEmployed
1106 28 17000 640 EasternCape Employed
1107 33 23000 660 NorthWest Employed
1108 46 37000 710 Gauteng Employed
1109 38 27000 685 Limpopo Employed
1110 25 15000 600 FreeState Unemployed
1111 40 31000 705 Mpumalanga Employed
1112 36 25000 680 KwaZuluNatal Employed
1113 43 33000 715 WesternCape Employed
1114 55 39000 735 Gauteng Retired
1115 27 16000 620 EasternCape Employed
1116 31 20000 650 Limpopo Employed
1117 49 41000 730 NorthWest Employed
1118 29 19000 660 FreeState Employed
1119 41 31000 700 WesternCape Employed
1120 30 21000 670 Gauteng Employed
1121 48 40000 720 KwaZuluNatal Employed
1122 34 22000 675 Mpumalanga Employed
1123 37 26000 685 Limpopo Employed
1124 44 34000 710 WesternCape Employed
1125 28 18000 650 EasternCape Employed
1126 53 37000 735 Gauteng SelfEmployed
1127 25 14000 600 FreeState Unemployed
1128 39 28000 690 NorthWest Employed
1129 33 23000 665 WesternCape Employed
1130 50 36000 720 KwaZuluNatal Employed
1131 42 32000 705 Gauteng Employed
1132 56 40000 740 Limpopo Retired
1133 26 16000 620 Mpumalanga Employed
1134 31 21000 640 NorthWest Employed
1135 45 35000 715 WesternCape Employed
1136 38 27000 690 Gauteng Employed
1137 49 39000 730 KwaZuluNatal SelfEmployed
1138 24 13000 570 EasternCape Unemployed
1139 35 24000 680 Limpopo Employed
1140 40 31000 700 WesternCape Employed
1141 28 18000 640 FreeState Employed
1142 46 36000 720 Mpumalanga Employed
1143 32 21000 660 KwaZuluNatal Employed
1144 54 38000 735 Gauteng Retired
1145 30 20000 650 Limpopo Employed
1146 43 33000 710 NorthWest Employed
1147 36 25000 685 WesternCape Employed
1148 51 35000 720 KwaZuluNatal SelfEmployed
1149 27 17000 630 EasternCape Employed
1150 39 29000 700 Gauteng Employed
1151 47 37000 715 Limpopo Employed
1152 55 40000 740 WesternCape Retired
1153 29 19000 665 FreeState Employed
1154 34 23000 670 Mpumalanga Employed
1155 50 36000 725 KwaZuluNatal Employed
1156 31 21000 655 Limpopo Employed
1157 48 39000 730 Gauteng Employed
1158 25 14000 600 EasternCape Unemployed
1159 37 26000 690 WesternCape Employed
1160 41 31000 705 Mpumalanga Employed
1161 28 18000 640 FreeState Employed
1162 52 37000 730 KwaZuluNatal SelfEmployed
1163 33 22000 675 Gauteng Employed
1164 44 34000 710 WesternCape Employed
1165 30 20000 660 Limpopo Employed
1166 38 28000 695 NorthWest Employed
1167 49 40000 735 Gauteng Employed
1168 27 17000 630 EasternCape Employed
1169 43 32000 705 WesternCape Employed
1170 35 24000 685 KwaZuluNatal Employed
1171 54 39000 740 Gauteng Retired
1172 29 19000 660 Mpumalanga Employed
1173 46 36000 720 WesternCape Employed
1174 32 21000 670 Limpopo Employed
1175 50 37000 725 KwaZuluNatal SelfEmployed
1176 28 18000 640 FreeState Employed
1177 40 30000 710 NorthWest Employed
1178 48 39000 730 Gauteng Employed
1179 26 16000 620 EasternCape Employed
1180 39 28000 695 WesternCape Employed
1181 45 35000 715 KwaZuluNatal Employed
1182 31 21000 665 Limpopo Employed
1183 52 38000 735 Gauteng Retired
1184 34 23000 670 Mpumalanga Employed
1185 47 36000 720 WesternCape Employed
1186 25 14000 600 FreeState Unemployed
1187 38 27000 690 Limpopo Employed
1188 49 40000 735 KwaZuluNatal Employed
1189 30 20000 660 NorthWest Employed
1190 44 34000 710 Gauteng Employed
1191 36 25000 685 WesternCape Employed
1192 53 37000 735 KwaZuluNatal SelfEmployed
1193 27 17000 630 EasternCape Employed
1194 41 31000 705 Limpopo Employed
1195 33 22000 675 Mpumalanga Employed
1196 50 37000 720 Gauteng Employed
1197 28 18000 640 FreeState Employed
1198 42 32000 710 WesternCape Employed
1199 55 40000 740 KwaZuluNatal Retired
1200 29 19000 665 NorthWest Employed
;
run;


/* Loan Data - 200 Observations, IDs 5001-5200, ~35% Defaulted */
data loan_data;
    input loan_id customer_id loan_amount interest_rate term_months loan_status $ months_paid product_type $;
    datalines;
5001 1001 50000 12.5 36 Active 20 PersonalLoan
5002 1002 800000 14.0 48 Active 120 HomeLoan
5003 1003 30000 15.0 24 Defaulted 10 PersonalLoan
5004 1004 600000 11.0 36 Active 60 CarLoan
5005 1005 40000 13.5 24 Closed 24 CreditCard
5006 1006 25000 18.0 12 Defaulted 5 PersonalLoan
5007 1007 400000 10.0 60 Active 48 CarLoan
5008 1008 35000 16.0 24 Active 18 PersonalLoan
5009 1009 40000 15.5 36 Defaulted 12 PersonalLoan
5010 1010 800000 14.5 60 Active 16 HomeLoan
5011 1011 90000 13.0 36 Defaulted 15 CarLoan
5012 1012 250000 10.5 48 Active 26 HomeLoan
5013 1013 45000 17.5 24 Active 20 PersonalLoan
5014 1014 120000 15.0 36 Defaulted 8 CarLoan
5015 1015 550000 11.5 60 Active 40 HomeLoan
5016 1016 30000 19.0 24 Defaulted 6 CreditCard
5017 1017 75000 12.0 36 Active 24 PersonalLoan
5018 1018 500000 9.0 60 Active 55 HomeLoan
5019 1019 40000 16.0 24 Defaulted 9 CreditCard
5020 1020 320000 14.0 48 Active 30 CarLoan
5021 1021 25000 17.5 24 Defaulted 7 PersonalLoan
5022 1022 700000 10.0 60 Active 52 HomeLoan
5023 1023 35000 15.5 24 Active 20 CreditCard
5024 1024 420000 11.0 48 Defaulted 18 CarLoan
5025 1025 28000 18.0 12 Defaulted 4 PersonalLoan
5026 1026 300000 9.5 36 Active 25 HomeLoan
5027 1027 38000 16.5 24 Active 22 PersonalLoan
5028 1028 470000 13.0 48 Active 38 HomeLoan
5029 1029 50000 12.0 36 Closed 36 CarLoan
5030 1030 25000 18.5 12 Defaulted 5 CreditCard
5031 1031 520000 9.0 60 Active 48 HomeLoan
5032 1032 28000 17.0 24 Active 22 PersonalLoan
5033 1033 150000 11.5 48 Active 44 CarLoan
5034 1034 20000 19.0 12 Defaulted 3 PersonalLoan
5035 1035 600000 10.0 60 Active 55 HomeLoan
5036 1036 42000 16.0 24 Defaulted 9 CreditCard
5037 1037 80000 13.5 36 Active 25 CarLoan
5038 1038 720000 9.0 60 Active 58 HomeLoan
5039 1039 40000 18.0 24 Defaulted 8 PersonalLoan
5040 1040 100000 12.5 36 Closed 36 CarLoan
5041 1041 90000 13.0 48 Defaulted 15 PersonalLoan
5042 1042 480000 11.0 60 Active 40 HomeLoan
5043 1043 30000 17.5 24 Active 20 CreditCard
5044 1044 700000 10.5 60 Active 50 HomeLoan
5045 1045 25000 19.0 12 Defaulted 4 PersonalLoan
5046 1046 220000 15.0 48 Defaulted 16 CarLoan
5047 1047 650000 9.5 60 Active 58 HomeLoan
5048 1048 45000 14.5 36 Active 30 PersonalLoan
5049 1049 90000 13.5 36 Closed 36 CarLoan
5050 1050 26000 17.0 24 Defaulted 6 CreditCard
5051 1051 740000 10.0 60 Active 56 HomeLoan
5052 1052 32000 15.5 24 Active 18 PersonalLoan
5053 1053 180000 11.5 48 Defaulted 22 CarLoan
5054 1054 35000 16.0 24 Active 20 CreditCard
5055 1055 420000 9.0 60 Active 50 HomeLoan
5056 1056 25000 18.0 12 Defaulted 5 PersonalLoan
5057 1057 80000 13.0 36 Active 28 CarLoan
5058 1058 380000 12.0 48 Active 40 HomeLoan
5059 1059 50000 15.5 24 Defaulted 7 CreditCard
5060 1060 90000 13.5 36 Active 34 PersonalLoan
5061 1061 450000 10.0 60 Active 45 HomeLoan
5062 1062 26000 19.0 12 Defaulted 4 CreditCard
5063 1063 320000 11.5 48 Active 30 CarLoan
5064 1064 40000 17.0 24 Active 18 PersonalLoan
5065 1065 200000 14.0 48 Defaulted 12 CarLoan
5066 1066 550000 9.0 60 Active 54 HomeLoan
5067 1067 37000 16.5 24 Defaulted 10 CreditCard
5068 1068 42000 15.0 24 Active 20 PersonalLoan
5069 1069 640000 11.0 60 Active 56 HomeLoan
5070 1070 100000 13.0 36 Closed 36 CarLoan
5071 1071 48000 18.0 24 Defaulted 8 PersonalLoan
5072 1072 750000 10.0 60 Active 55 HomeLoan
5073 1073 33000 17.5 24 Active 22 CreditCard
5074 1074 500000 9.5 48 Active 46 CarLoan
5075 1075 24000 19.0 12 Defaulted 4 PersonalLoan
5076 1076 290000 14.0 48 Active 30 HomeLoan
5077 1077 45000 13.5 24 Active 22 CreditCard
5078 1078 380000 11.5 60 Defaulted 20 HomeLoan
5079 1079 90000 12.0 36 Active 26 CarLoan
5080 1080 28000 17.0 24 Defaulted 9 PersonalLoan
5081 1081 420000 9.0 48 Active 44 HomeLoan
5082 1082 27000 18.5 12 Defaulted 5 CreditCard
5083 1083 95000 13.0 36 Active 30 CarLoan
5084 1084 530000 10.5 60 Active 52 HomeLoan
5085 1085 22000 19.0 12 Defaulted 3 PersonalLoan
5086 1086 380000 11.0 48 Active 42 CarLoan
5087 1087 28000 16.5 24 Active 20 CreditCard
5088 1088 600000 9.0 60 Active 55 HomeLoan
5089 1089 50000 14.5 24 Defaulted 7 PersonalLoan
5090 1090 70000 12.0 36 Closed 36 CarLoan
5091 1091 260000 11.5 48 Defaulted 18 HomeLoan
5092 1092 38000 16.0 24 Active 20 CreditCard
5093 1093 450000 10.0 60 Active 50 HomeLoan
5094 1094 24000 18.0 12 Defaulted 5 PersonalLoan
5095 1095 120000 13.5 36 Active 28 CarLoan
5096 1096 560000 9.5 60 Active 58 HomeLoan
5097 1097 27000 17.0 24 Active 18 CreditCard
5098 1098 220000 14.0 48 Defaulted 14 CarLoan
5099 1099 340000 10.0 48 Active 40 HomeLoan
5100 1100 20000 19.0 12 Defaulted 4 PersonalLoan
5101 1101 80000 12.5 36 Active 30 CarLoan
5102 1102 400000 11.0 48 Active 38 HomeLoan
5103 1103 28000 18.0 24 Defaulted 8 CreditCard
5104 1104 120000 13.0 36 Active 32 PersonalLoan
5105 1105 600000 9.0 60 Active 50 HomeLoan
5106 1106 25000 19.0 12 Defaulted 5 PersonalLoan
5107 1107 320000 10.5 48 Active 42 CarLoan
5108 1108 27000 16.0 24 Active 18 CreditCard
5109 1109 550000 9.0 60 Active 55 HomeLoan
5110 1110 43000 15.5 24 Defaulted 10 PersonalLoan
5111 1111 90000 12.0 36 Active 28 CarLoan
5112 1112 420000 11.5 48 Active 46 HomeLoan
5113 1113 30000 17.0 24 Active 20 CreditCard
5114 1114 380000 10.0 48 Defaulted 15 HomeLoan
5115 1115 25000 18.0 12 Defaulted 5 PersonalLoan
5116 1116 70000 13.5 36 Active 30 CarLoan
5117 1117 600000 9.5 60 Active 56 HomeLoan
5118 1118 26000 17.0 24 Active 20 CreditCard
5119 1119 220000 14.0 48 Defaulted 12 CarLoan
5120 1120 450000 10.5 60 Active 54 HomeLoan
5121 1121 40000 16.0 24 Defaulted 9 PersonalLoan
5122 1122 100000 13.0 36 Closed 36 CarLoan
5123 1123 350000 11.0 48 Active 44 HomeLoan
5124 1124 25000 19.0 12 Defaulted 4 CreditCard
5125 1125 85000 12.5 36 Active 32 PersonalLoan
5126 1126 540000 9.0 60 Active 50 HomeLoan
5127 1127 30000 16.5 24 Defaulted 10 PersonalLoan
5128 1128 200000 14.5 48 Active 38 CarLoan
5129 1129 27000 17.5 24 Active 22 CreditCard
5130 1130 370000 10.0 48 Active 45 HomeLoan
5131 1131 28000 18.5 12 Defaulted 6 PersonalLoan
5132 1132 150000 12.0 36 Active 30 CarLoan
5133 1133 420000 11.0 48 Active 44 HomeLoan
5134 1134 26000 17.5 24 Active 20 CreditCard
5135 1135 480000 10.5 60 Defaulted 22 HomeLoan
5136 1136 24000 18.0 12 Defaulted 5 PersonalLoan
5137 1137 95000 12.5 36 Active 30 CarLoan
5138 1138 500000 9.0 60 Active 54 HomeLoan
5139 1139 30000 17.0 24 Active 18 CreditCard
5140 1140 220000 13.0 48 Defaulted 10 CarLoan
5141 1141 600000 9.5 60 Active 55 HomeLoan
5142 1142 25000 18.5 12 Defaulted 4 PersonalLoan
5143 1143 330000 11.0 48 Active 40 CarLoan
5144 1144 27000 16.5 24 Active 20 CreditCard
5145 1145 460000 9.0 60 Active 50 HomeLoan
5146 1146 38000 15.5 24 Defaulted 8 PersonalLoan
5147 1147 85000 12.0 36 Active 30 CarLoan
5148 1148 380000 10.0 48 Active 44 HomeLoan
5149 1149 25000 17.0 24 Active 20 CreditCard
5150 1150 250000 13.5 48 Defaulted 16 CarLoan
5151 1151 500000 9.5 60 Active 56 HomeLoan
5152 1152 26000 18.5 12 Defaulted 5 PersonalLoan
5153 1153 400000 10.5 48 Active 42 CarLoan
5154 1154 28000 16.0 24 Active 18 CreditCard
5155 1155 550000 9.0 60 Active 50 HomeLoan
5156 1156 32000 17.5 24 Defaulted 8 PersonalLoan
5157 1157 70000 12.0 36 Active 30 CarLoan
5158 1158 420000 10.0 48 Active 46 HomeLoan
5159 1159 24000 18.0 12 Defaulted 4 PersonalLoan
5160 1160 360000 11.0 48 Active 44 CarLoan
5161 1161 26000 17.5 24 Active 20 CreditCard
5162 1162 600000 9.5 60 Active 55 HomeLoan
5163 1163 35000 16.0 24 Defaulted 7 PersonalLoan
5164 1164 100000 12.5 36 Active 30 CarLoan
5165 1165 400000 10.0 48 Active 48 HomeLoan
5166 1166 28000 17.0 24 Active 22 CreditCard
5167 1167 500000 9.0 60 Active 50 HomeLoan
5168 1168 32000 15.5 24 Defaulted 9 PersonalLoan
5169 1169 250000 10.5 48 Active 44 CarLoan
5170 1170 27000 18.0 24 Active 20 CreditCard
5171 1171 450000 9.0 60 Active 50 HomeLoan
5172 1172 40000 16.5 24 Defaulted 8 PersonalLoan
5173 1173 90000 12.0 36 Active 30 CarLoan
5174 1174 380000 10.0 48 Active 46 HomeLoan
5175 1175 25000 17.0 24 Defaulted 6 CreditCard
5176 1176 700000 9.5 60 Active 55 HomeLoan
5177 1177 28000 18.0 12 Defaulted 5 PersonalLoan
5178 1178 320000 11.0 48 Active 42 CarLoan
5179 1179 24000 17.5 24 Active 18 CreditCard
5180 1180 550000 9.0 60 Active 50 HomeLoan
5181 1181 35000 16.0 24 Defaulted 7 PersonalLoan
5182 1182 120000 13.5 36 Active 30 CarLoan
5183 1183 380000 10.0 48 Active 44 HomeLoan
5184 1184 27000 18.0 12 Defaulted 5 PersonalLoan
5185 1185 300000 10.5 48 Active 42 CarLoan
5186 1186 26000 17.5 24 Active 18 CreditCard
5187 1187 400000 9.0 60 Active 50 HomeLoan
5188 1188 50000 15.0 24 Defaulted 8 PersonalLoan
5189 1189 90000 12.5 36 Active 30 CarLoan
5190 1190 380000 10.0 48 Active 46 HomeLoan
5191 1191 24000 18.0 12 Defaulted 5 PersonalLoan
5192 1192 600000 9.5 60 Active 55 HomeLoan
5193 1193 28000 17.5 24 Active 20 CreditCard
5194 1194 350000 10.0 48 Active 44 HomeLoan
5195 1195 26000 18.0 24 Defaulted 8 PersonalLoan
5196 1196 400000 10.5 48 Active 42 CarLoan
5197 1197 27000 17.0 24 Active 18 CreditCard
5198 1198 550000 9.0 60 Active 50 HomeLoan
5199 1199 30000 16.5 24 Defaulted 9 PersonalLoan
5200 1200 450000 10.0 48 Active 46 HomeLoan
;
run;


/*Input transaction data*/
data transaction_data;
    input customer_id month $ total_txn_amt avg_txn_amt num_txns;
    datalines;
1001 Sep 21000 700 30
1002 Sep 28000 933 30
1003 Sep 8000 400 20
1004 Sep 15000 500 30
1005 Sep 12000 600 20
1006 Sep 3000 300 10
1007 Sep 35000 875 40
1008 Sep 10000 500 20
1009 Sep 6000 300 20
1010 Sep 9000 450 20
1011 Aug 18000 600 30
1012 Jul 12000 400 30
1013 Sep 24000 800 30
1014 Aug 15000 500 30
1015 Sep 32000 640 50
1016 Sep 28000 933 30
1017 Jul 40000 800 50
1018 Aug 36000 900 40
1019 Sep 9000 450 20
1020 Jul 11000 367 30
1021 Aug 27000 900 30
1022 Sep 18000 600 30
1023 Jul 45000 750 60
1024 Sep 16000 533 30
1025 Aug 22000 733 30
1026 Sep 15000 500 30
1027 Jul 12000 400 30
1028 Sep 25000 625 40
1029 Aug 8000 400 20
1030 Jul 19000 633 30
1031 Sep 30000 750 40
1032 Sep 21000 700 30
1033 Jul 34000 850 40
1034 Aug 28000 933 30
1035 Sep 12000 400 30
1036 Sep 17000 566 30
1037 Aug 26000 867 30
1038 Jul 9000 450 20
1039 Sep 31000 775 40
1040 Jul 15000 500 30
1041 Aug 22000 550 40
1042 Sep 26000 866 30
1043 Jul 8000 400 20
1044 Aug 33000 825 40
1045 Sep 29000 725 40
1046 Sep 15000 500 30
1047 Aug 12000 400 30
1048 Jul 40000 800 50
1049 Sep 23000 767 30
1050 Aug 10000 500 20
1051 Jul 14000 467 30
1052 Aug 28000 933 30
1053 Sep 35000 875 40
1054 Jul 6000 300 20
1055 Sep 32000 800 40
1056 Aug 25000 625 40
1057 Jul 9000 450 20
1058 Aug 42000 700 60
1059 Sep 17000 566 30
1060 Jul 38000 950 40
1061 Sep 11000 367 30
1062 Jul 23000 767 30
1063 Sep 24000 800 30
1064 Aug 19000 633 30
1065 Jul 15000 500 30
1066 Aug 9000 450 20
1067 Sep 26000 867 30
1068 Jul 21000 700 30
1069 Aug 17000 566 30
1070 Sep 30000 750 40
1071 Jul 33000 825 40
1072 Aug 20000 500 40
1073 Sep 27000 900 30
1074 Jul 35000 875 40
1075 Sep 10000 500 20
1076 Aug 16000 533 30
1077 Sep 40000 800 50
1078 Jul 19000 633 30
1079 Aug 12000 400 30
1080 Sep 21000 700 30
1081 Jul 24000 800 30
1082 Aug 15000 500 30
1083 Sep 26000 867 30
1084 Jul 8000 400 20
1085 Aug 30000 750 40
1086 Sep 18000 600 30
1087 Jul 28000 933 30
1088 Sep 19000 633 30
1089 Aug 40000 800 50
1090 Jul 9000 450 20
1091 Sep 23000 767 30
1092 Aug 16000 533 30
1093 Jul 32000 800 40
1094 Sep 22000 550 40
1095 Aug 10000 500 20
1096 Jul 27000 900 30
1097 Sep 34000 850 40
1098 Aug 15000 500 30
1099 Jul 19000 633 30
1100 Sep 30000 750 40
1101 Aug 42000 700 60
1102 Jul 31000 775 40
1103 Sep 9000 450 20
1104 Aug 27000 900 30
1105 Jul 13000 433 30
1106 Sep 35000 875 40
1107 Aug 24000 800 30
1108 Jul 20000 500 40
1109 Sep 32000 640 50
1110 Aug 14000 467 30
1111 Jul 9000 450 20
1112 Sep 28000 933 30
1113 Aug 10000 500 20
1114 Jul 25000 625 40
1115 Sep 15000 500 30
1116 Aug 30000 750 40
1117 Jul 8000 400 20
1118 Sep 20000 667 30
1119 Aug 33000 825 40
1120 Jul 35000 875 40
1121 Sep 26000 867 30
1122 Aug 9000 450 20
1123 Jul 23000 767 30
1124 Sep 31000 775 40
1125 Aug 19000 633 30
1126 Jul 27000 900 30
1127 Sep 34000 850 40
1128 Aug 15000 500 30
1129 Jul 21000 700 30
1130 Sep 29000 725 40
1131 Aug 17000 566 30
1132 Jul 22000 550 40
1133 Sep 12000 400 30
1134 Aug 38000 950 40
1135 Jul 16000 533 30
1136 Sep 25000 625 40
1137 Aug 10000 500 20
1138 Jul 30000 750 40
1139 Sep 21000 700 30
1140 Aug 18000 600 30
1141 Jul 12000 400 30
1142 Sep 28000 933 30
1143 Aug 33000 825 40
1144 Jul 26000 867 30
1145 Sep 15000 500 30
1146 Aug 20000 500 40
1147 Jul 31000 775 40
1148 Sep 9000 450 20
1149 Aug 35000 875 40
1150 Jul 8000 400 20
1151 Sep 16000 533 30
1152 Aug 23000 767 30
1153 Jul 19000 633 30
1154 Sep 42000 700 60
1155 Aug 27000 900 30
1156 Jul 32000 800 40
1157 Sep 30000 750 40
1158 Aug 13000 433 30
1159 Jul 22000 550 40
1160 Sep 24000 800 30
1161 Aug 20000 500 40
1162 Jul 34000 850 40
1163 Sep 10000 500 20
1164 Aug 18000 600 30
1165 Jul 25000 625 40
1166 Sep 15000 500 30
1167 Aug 21000 700 30
1168 Jul 28000 933 30
1169 Sep 17000 566 30
1170 Aug 12000 400 30
1171 Jul 30000 750 40
1172 Sep 27000 900 30
1173 Aug 9000 450 20
1174 Jul 23000 767 30
1175 Sep 35000 875 40
1176 Aug 24000 800 30
1177 Jul 18000 600 30
1178 Sep 32000 640 50
1179 Aug 10000 500 20
1180 Jul 15000 500 30
1181 Sep 31000 775 40
1182 Aug 13000 433 30
1183 Jul 35000 875 40
1184 Sep 19000 633 30
1185 Aug 26000 867 30
1186 Jul 20000 500 40
1187 Sep 40000 800 50
1188 Aug 9000 450 20
1189 Jul 22000 550 40
1190 Sep 29000 725 40
1191 Aug 25000 625 40
1192 Jul 33000 825 40
1193 Sep 12000 400 30
1194 Aug 17000 566 30
1195 Jul 28000 933 30
1196 Sep 34000 850 40
1197 Aug 9000 450 20
1198 Jul 21000 700 30
1199 Sep 31000 775 40
1200 Aug 40000 800 50
;
run;

/*EDA Exploratory Data Analysis for each dataset*/

proc means data=customer_info n mean median min max std; 
   var age income credit_score;
run;

proc means data=loan_data n mean median min max std;
   var loan_amount interest_rate term_months months_paid;
run;

proc means data=transaction_data n mean median min max std;
   var total_txn_amt avg_txn_amt num_txns;
run;

/*To check if there are any spelling errors*/

proc freq data=customer_info;
   tables region employment_status / nocum;
run;

proc freq data=loan_data;
   tables loan_status product_type / nocum;
run;

proc freq data=transaction_data;
   tables month / nocum;
run;


/*how many missing values in a column there are*/
proc means data = customer_info n nmiss
mean min max;
run;

/*to assess how clients are performing within this loan category*/
proc freq data = loan_data;
tables loan_status;
run;


/* Set output path for images */
ods listing gpath="~/Graphs";
ods graphics on;

/*Customer Info: Income Distribution by Region*/
ods graphics / imagename="income_by_region" imagefmt=png;
proc sgplot data=customer_info;
    vbox income / category=region;
    title "Income Distribution by Region";
run;

/*Customer Info: Credit Score by Employment Status*/
ods graphics / imagename="credit_score_by_employment_status" imagefmt=png;
proc sgplot data=customer_info;
    vbox credit_score / category=employment_status;
    title "Credit Score by Employment Status";
run;

/*Loan Data: Loan Amount by Product Type*/
ods graphics / imagename="loan_amount_by_product_type" imagefmt=png;
proc sgplot data=loan_data;
    vbox loan_amount / category=product_type;
    title "Loan Amount by Product Type";
run;

/*Loan Data: Interest Rate by Loan Status*/
ods graphics / imagename="interest_rate_by_loan_status" imagefmt=png;
proc sgplot data=loan_data;
    vbox interest_rate / category=loan_status;
    title "Interest Rate by Loan Status";
run;

/*Transaction Data: Total Transaction Amount by Month*/
ods graphics / imagename="total_txn_amt_by_month" imagefmt=png;
proc sgplot data=transaction_data;
    vbox total_txn_amt / category=month;
    title "Total Transaction Amount by Month";
run;

/*Turn off ODS Graphics */
ods graphics off;
ods listing close;



/*flag customers with missing credit score values or missing income*/
data customer_info_clean;
set customer_info;
if missing(credit_score) or credit_score < 0 then data_issue = "Invalid credit score";
else if missing(income) or income <= 0 then data_issue = "Invalid Income";
else data_issue = "Valid";
run;

/*Combine all three tables and add loan to income ratio, payment ratio, total txn to income loan*/

proc sql;
create table risk_data as 
select
    a.customer_id,
    a.age,
    a.income,
    a.credit_score,
    a.region,
    b.product_type,
    b.loan_status,
    b.loan_amount,
    b.months_paid,
    b.term_months,
    c.num_txns,
    c.total_txn_amt,
    c.avg_txn_amt,
    (b.loan_amount / a.income) as 
loan_to_income_ratio,
    (b.months_paid / a.income) 
as payment_ratio,
    (c.total_txn_amt / a.income)
as txn_to_income_ratio
    from customer_info a
    left join loan_data b
        on a.customer_id =
b.customer_id
    left join transaction_data c
         on a.customer_id = 
c.customer_id;
quit;

/*Creating a Risk flag system*/
proc sql;
create table Risk_Flagging_Exposure as 
select
    case
        when credit_score >= 750
then "Low Risk"
            when credit_score between
600 and 749 then "Medium Risk"
            else "High Risk"
         end as risk_segment,
         sum(loan_amount) as
total_exposure,
         avg(loan_amount) as avg_loan,
         count(distinct customer_id) as
num_customers
    from risk_data
    group by risk_segment;
quit;


data loan_data_final;
   set risk_data;
   if credit_score >= 750 and loan_to_income < 0.3 and payment_ratio < 0.25 then risk_flag = 1;
   else if credit_score >= 600 and credit_score <= 749 
        and loan_to_income >= 0.3 and loan_to_income <= 0.6 then risk_flag = 2;
   else risk_flag = 3;
run;


/*Create a folder in SAS OnDemand to store your plots*/
ods listing gpath="~/Graphs";  /* Save images to your "graphs" folder */
ods graphics on;

/*Number of Customers by Risk Segment*/
ods graphics / imagename="num_customers_by_risk_segment" imagefmt=png;
proc sgplot data=Risk_Flagging_Exposure;
    vbar risk_segment / response=num_customers datalabel;
    title "Number of Customers by Risk Segment";
run;

/*Total Loan Exposure by Risk Segment*/
ods graphics / imagename="total_loan_exposure_by_risk_segment" imagefmt=png;
proc sgplot data=Risk_Flagging_Exposure;
    vbar risk_segment / response=total_exposure datalabel;
    title "Total Loan Exposure by Risk Segment";
run;

/*Distribution of Loan Amounts by Risk Flag*/
ods graphics / imagename="loan_amount_by_risk_flag" imagefmt=png;
proc sgplot data=loan_data_final;
    vbox loan_amount / category=risk_flag;
    title "Distribution of Loan Amounts by Risk Flag";
run;

/*Credit Score Distribution by Risk Flag*/
ods graphics / imagename="credit_score_distribution_by_risk_flag" imagefmt=png;
proc sgplot data=loan_data_final;
    histogram credit_score / group=risk_flag transparency=0.3;
    density credit_score / type=kernel group=risk_flag;
    title "Distribution of Credit Scores by Risk Flag";
run;

/*Loan-to-Income Ratio vs. Credit Score*/
ods graphics / imagename="loan_to_income_vs_credit_score" imagefmt=png;
proc sgplot data=loan_data_final;
    scatter x=loan_to_income_ratio y=credit_score / group=risk_flag;
    title "Loan-to-Income Ratio vs Credit Score by Risk Flag";
run;

/*Payment Ratio Distribution by Risk Flag*/
ods graphics / imagename="payment_ratio_by_risk_flag" imagefmt=png;
proc sgplot data=loan_data_final;
    vbox payment_ratio / category=risk_flag;
    title "Payment Ratio Distribution by Risk Flag";
run;

ods graphics off;
ods listing close;


/*Exposure according to region and loan type*/

proc sql;
 create table portfolio_exposure as
 select 
    region,
    product_type,
    sum(loan_amount) as
total_exposure format=comma12.,
    avg(loan_amount) as avg_loan,
    count(distinct customer_id) as 
num_customers
    from loan_data_final
    group by region, product_type;
quit;

      
/*Bar graph to show the average for each loan product in each province to measure the total exposure*/
proc sgplot data=portfolio_exposure;
title "Portfolio Exposure by Region and Product_type";
    vbar product_type / 
response=total_exposure
group=region groupdisplay=cluster
datalabel;
    yaxis  label="Total Exposure (ZAR)";
    xaxis label="Product Type";
run;


/*Modelling Process*/

data loan_data_clean;
    set loan_data_final;

/*Remove spaces and force uppercase*/
loan_status_clean = compress(upcase(loan_status));

    
if loan_status_clean in ("DEFAULT", "DEFAULTE", "DEFAULTED") then loan_status_clean = "DEFAULTED";
else if loan_status_clean in ("ACTIVE", "ACTIV", "ACTVE") then loan_status_clean = "ACTIVE";
else if loan_status_clean in ("CLOSED", "CLOSE", "CLS") then loan_status_clean = "CLOSED";

/* Create numeric default flag */
if loan_status_clean = "DEFAULTED" then default_flag = 1;
else if loan_status_clean in ("ACTIVE", "CLOSED") then default_flag = 0;
else default_flag = .;
run;

proc freq data=loan_data_clean;
tables loan_status_clean*default_flag / missing;
run;

/*Logistic Regression*/
proc logistic data=loan_data_clean descending;
model default_flag = credit_score income loan_amount term_months loan_to_income payment_ratio;
output out=credit_ratings p=p_1;
run;

proc means data=credit_ratings mean std min max;
var p_1;
run;

/*Credit Ratings using Model*/
data credit_ratings;
set predicted_results;
if p_1 < 0.2 then credit_rating = "A - Very Low Risk";
else if p_1 < 0.4 then credit_rating = "B - Low Risk";
else if p_1 < 0.6 then credit_rating = "C - Moderate Risk";
else if p_1 < 0.8 then credit_rating = "D - High Risk";
else credit_rating = "E - Very High Risk";
run;

/*Histogram to plot probabilities*/
proc sgplot data=credit_ratings;
histogram p_1 / transparency=0.2;
density p_1;
title "Distribution of Predicted Default Probabilities";
run;

/*Exporting Files*/

/* Export customer_info */
proc export data=customer_info
outfile="~/customer_info.csv"
dbms=csv
replace;
run;

/* Export loan_data_final */
proc export data=loan_data_final
outfile="~/loan_data_final.csv"
dbms=csv
replace;
run;

/* Export transaction_data */
proc export data=transaction_data
outfile="~/transaction_data.csv"
dbms=csv
replace;
run;








       










